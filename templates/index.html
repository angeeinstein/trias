<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRIAS - Ã–ffentliche Verkehrsdaten</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=4">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸšŒ TRIAS Fahrplanauskunft</h1>
            <p class="subtitle">Echtzeitdaten fÃ¼r Ã¶ffentliche Verkehrsmittel in Ã–sterreich</p>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="search">ğŸ” Haltestellensuche</button>
            <button class="tab-button" data-tab="nearby">ğŸ“ In der NÃ¤he</button>
            <button class="tab-button" data-tab="departures">ğŸš Abfahrten</button>
            <button class="tab-button" data-tab="route">ğŸ—ºï¸ Route planen</button>
            <button class="tab-button" data-tab="cache">âš¡ Cache</button>
        </div>

        <!-- Tab: Search by Name -->
        <div id="search-tab" class="tab-content active">
            <div class="card">
                <h2>Haltestelle suchen</h2>
                <div class="search-box">
                    <input type="text" id="search-input" placeholder="z.B. Hauptplatz, Jakominiplatz..." />
                    <button id="search-btn" class="btn btn-primary">Suchen</button>
                </div>
                <div id="search-results" class="results-container"></div>
            </div>
        </div>

        <!-- Tab: Nearby Stops -->
        <div id="nearby-tab" class="tab-content">
            <div class="card">
                <h2>Haltestellen in der NÃ¤he</h2>
                <div class="form-group">
                    <label for="lat-input">Breitengrad (Latitude):</label>
                    <input type="number" id="lat-input" step="0.000001" placeholder="47.069250" />
                </div>
                <div class="form-group">
                    <label for="lon-input">LÃ¤ngengrad (Longitude):</label>
                    <input type="number" id="lon-input" step="0.000001" placeholder="15.409852" />
                </div>
                <div class="form-group">
                    <label for="radius-input">Radius (Meter):</label>
                    <input type="number" id="radius-input" value="500" min="100" max="5000" step="100" />
                </div>
                <div class="button-group">
                    <button id="nearby-btn" class="btn btn-primary">Suchen</button>
                    <button id="geolocation-btn" class="btn btn-secondary">ğŸ“ Meinen Standort verwenden</button>
                </div>
                <div id="nearby-results" class="results-container"></div>
            </div>
        </div>

        <!-- Tab: Departures -->
        <div id="departures-tab" class="tab-content">
            <div class="card">
                <h2>Abfahrtszeiten</h2>
                <div class="form-group">
                    <label for="stop-id-input">Haltestellen-ID:</label>
                    <input type="text" id="stop-id-input" placeholder="z.B. at:46:7960" />
                    <small>Tipp: Suchen Sie zuerst nach einer Haltestelle, um die ID zu erhalten</small>
                </div>
                <div class="form-group">
                    <label for="departure-limit">Anzahl der Abfahrten:</label>
                    <input type="number" id="departure-limit" value="12" min="1" max="50" />
                </div>
                <div class="form-group">
                    <label for="departure-window">Zeitfenster (Minuten):</label>
                    <input type="number" id="departure-window" value="60" min="15" max="240" step="15" />
                </div>
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="realtime-check" checked />
                        Echtzeitdaten einbeziehen
                    </label>
                </div>
                <button id="departures-btn" class="btn btn-primary">Abfahrten abrufen</button>
                <div id="departures-results" class="results-container"></div>
            </div>
        </div>

        <!-- Tab: Route Planning -->
        <div id="route-tab" class="tab-content">
            <div class="card">
                <h2>Route planen</h2>
                <div class="form-group">
                    <label for="route-origin">Von (Start):</label>
                    <input type="text" id="route-origin" placeholder="z.B. Hauptplatz, Jakominiplatz..." />
                </div>
                <div class="form-group">
                    <label for="route-destination">Nach (Ziel):</label>
                    <input type="text" id="route-destination" placeholder="z.B. Jakominiplatz, Joanneum..." />
                </div>
                <div class="form-group">
                    <label for="route-limit">Anzahl der Verbindungen:</label>
                    <input type="number" id="route-limit" value="5" min="1" max="10" />
                </div>
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="route-realtime-check" checked />
                        Echtzeitdaten einbeziehen
                    </label>
                </div>
                <button id="route-btn" class="btn btn-primary">Route suchen</button>
                <div id="route-results" class="results-container"></div>
            </div>
        </div>

        <!-- Tab: Cache Management -->
        <div id="cache-tab" class="tab-content">
            <div class="card">
                <h2>Cache Verwaltung</h2>
                
                <!-- Cache Statistics -->
                <div id="cache-stats" class="cache-stats">
                    <div class="stat-item">
                        <span class="stat-label">Gespeicherte Haltestellen:</span>
                        <span id="cache-stop-count" class="stat-value">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Cache Alter:</span>
                        <span id="cache-age" class="stat-value">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Status:</span>
                        <span id="cache-status" class="stat-value">-</span>
                    </div>
                </div>

                <button id="cache-refresh-btn" class="btn btn-secondary">Statistik aktualisieren</button>

                <hr style="margin: 20px 0; border: none; border-top: 1px solid #e0e0e0;">

                <!-- Cache Building Configuration -->
                <h3>Cache automatisch aufbauen</h3>
                <p style="color: #666; font-size: 0.9em; margin-bottom: 15px;">
                    Baut den Cache automatisch auf, indem Haltestellen in Ã¶sterreichischen StÃ¤dten abgefragt werden.
                    Dies verbessert die Suchgeschwindigkeit erheblich.
                </p>

                <div class="form-group">
                    <label for="stops-per-city">Haltestellen pro Stadt:</label>
                    <input type="number" id="stops-per-city" value="100" min="10" max="500" step="10" />
                    <small style="color: #666; display: block; margin-top: 5px;">
                        HÃ¶here Werte = mehr Daten, lÃ¤ngere Laufzeit
                    </small>
                </div>

                <div class="cache-controls">
                    <button id="cache-build-btn" class="btn btn-primary">Cache aufbauen</button>
                    <button id="cache-stop-btn" class="btn btn-danger hidden">Abbrechen</button>
                </div>

                <!-- Progress Display -->
                <div id="cache-progress-container" class="progress-container hidden">
                    <div class="progress-info">
                        <span id="cache-current-city">-</span>
                        <span id="cache-progress-percent">0%</span>
                    </div>
                    <div class="progress-bar-bg">
                        <div id="cache-progress-bar" class="progress-bar"></div>
                    </div>
                    <div id="cache-progress-details" class="progress-details">-</div>
                </div>
            </div>
        </div>

        <footer>
            <p>Datenquelle: <a href="http://ogdtrias.verbundlinie.at:8183/stv/trias" target="_blank">TRIAS (Verbund Linie OGD)</a></p>
        </footer>
    </div>

    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Lade Daten...</p>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}?v=5"></script>
</body>
</html>
